import{Ea as C,Ga as f,Ha as L,Ia as h,Ja as o,Ka as E,La as n,Ma as N,Oa as O,Pa as I,Qa as b,a as m,e as s,f as R,g as d,n as v,q as u}from"./chunk-AIU7P5UL.js";var g=class p{constructor(e){this.firestore=e}COLLECTION_NAME="recipes";getAllRecipes(){let e=o(this.firestore,this.COLLECTION_NAME);return f(e,{idField:"id"})}getFavoriteRecipes(){let e=o(this.firestore,this.COLLECTION_NAME),r=O(e,b("favorite","==",!0));return f(r,{idField:"id"})}getRecipeById(e){let r=n(this.firestore,this.COLLECTION_NAME,e);return L(r,{idField:"id"})}setFavorite(e,r){let a=n(this.firestore,this.COLLECTION_NAME,e);return s(I(a,{favorite:r}))}searchRecipes(e){if(!e||e.length===0)return R([]);let r=o(this.firestore,this.COLLECTION_NAME),i=e.map(t=>t.toLowerCase()).map(t=>O(r,b("keywords","array-contains",t)));return s(Promise.all(i.map(t=>N(t)))).pipe(d(t=>{let l=new Map;return t.forEach(w=>{w.docs.forEach(c=>{l.has(c.id)||l.set(c.id,m({id:c.id},c.data()))})}),Array.from(l.values())}))}addRecipe(e){let r=[...e.title.split(" ").map(i=>i.toLowerCase()),...e.ingredients.map(i=>i.name.toLowerCase())];e.keywords=r;let a=o(this.firestore,this.COLLECTION_NAME);return s(h(a,e)).pipe(d(i=>i.id))}deleteRecipe(e){let r=n(this.firestore,this.COLLECTION_NAME,e);return s(E(r))}static \u0275fac=function(r){return new(r||p)(u(C))};static \u0275prov=v({token:p,factory:p.\u0275fac,providedIn:"root"})};export{g as a};
